# План проекта: GeekHeaven

## 1. Введение

Цель этого документа - подробно описать требования, архитектуру, функции и этапы разработки приложения GeekHeaven. GeekHeaven - это платформа для централизованного хранения, управления и получения рекомендаций по мультимедийному контенту.

## 2. Пользовательские истории и Функциональные требования

### **Функциональность: Достижения пользователей**

**Описание:**
Система достижений (ачивок) поощряет пользователей за активность и разнообразное взаимодействие с платформой. За выполнение определённых действий или достижение определённых целей пользователь получает соответствующее достижение, которое отображается в профиле и может быть публичным.

**Примеры сценариев получения достижений:**
- Добавил первый медиа-объект в библиотеку
- Оценил 10/50/100 объектов
- Оставил 5 разных отзывов
- Собрал коллекцию по определённой тематике ("Лучшие ужасы", "Классика аниме" и т.д.)
- Прошел марафон (например, посмотрел 10 фильмов за месяц)
- Использовал разные типы контента
- Получил максимальную оценку от других пользователей за отзыв ("Лучший критик" и т.п.)
- Тематические/сезонные ("Новогодний марафон", "Осенние премьеры")

**Взаимодействие:**
- Достижения отображаются в профиле пользователя (блок «Достижения», возможность расшарить список).
- Обратная связь (уведомление при присвоении).
- Часть достижений может быть скрыта («секретные» — открываются при выполнении условия).

**Пользовательские истории:**
- Как пользователь, я хочу получать визуальные достижения, чтобы видеть свой прогресс и делиться им с друзьями.
- Как пользователь, я хочу понимать, какие ачивки могу получить и как их открыть.

**Требования:**
- Хранение истории ачивок пользователя, даты получения, статуса (открыта/секретная).
- Масштабируемое добавление новых достижений без изменения основной логики приложения.

---

### 2.1. Основные сущности

*   **Достижение (Achievement):**
    *   ID
    *   Название
    *   Описание
    *   Тип (общая, тематическая, уникальная, секретная)
    *   Иконка
    *   Критерии получения (логическая формула или ссылка на обработчик)
*   **AchievementProgress** (Связь пользователь—ачивка):
    *   userId
    *   achievementId
    *   Дата получения
    *   Прогресс (для накопительных достижений)
    *   Статус (открыта/секретная)

*   **Пользователь (User):**
    *   Регистрация/Авторизация (email, username, password).
    *   Профиль пользователя (аватар, описание, статистика).
    *   Личная библиотека контента.
    *   Настройки (предпочтения по контенту, уведомления).
*   **Медиа-объект (MediaItem):**
    *   Общие атрибуты: ID, название, описание, постер/обложка, год выпуска, жанры, теги, рейтинг (средний), количество оценок, дата добавления в систему. Данные по этим атрибутам (кроме ID, рейтинга, количества оценок и даты добавления в систему) будут преимущественно получаться из общедоступных публичных API.
    *   Специфичные атрибуты для каждого типа контента (см. ниже) также будут получаться из внешних API.
*   **Коллекция/Список (Collection/List):**
    *   Создается пользователем.
    *   Может быть публичной или приватной.
    *   Содержит набор MediaItem.
    *   Название, описание.
*   **Отзыв (Review):**
    *   Привязан к MediaItem и User.
    *   Текст отзыва.
    *   Оценка (например, от 1 до 10).
    *   Дата создания/обновления.
*   **Вселенная/Серия (Universe/Series):**
    *   Группирует связанные MediaItem (например, книги одной серии, игры по одной вселенной).
    *   Название, описание.

### 2.2. Типы контента и их специфичные атрибуты

*   **Компьютерные игры (Game):**
    *   Платформы (PC, PS5, Xbox Series X/S, Nintendo Switch и т.д.).
    *   Разработчик.
    *   Издатель.
    *   Режим игры (однопользовательский, многопользовательский, кооперативный).
    *   Скриншоты, трейлеры.
*   **Фильмы и Сериалы (Movie/Series):**
    *   Тип (фильм, сериал).
    *   Режиссер(ы).
    *   Актерский состав.
    *   Длительность (для фильмов) / Количество сезонов и серий (для сериалов).
    *   Страна производства.
    *   Скриншоты, трейлеры.
*   **Книги (Book):**
    *   Автор(ы).
    *   Издательство.
    *   Количество страниц.
    *   ISBN.
    *   Форматы (бумажная, электронная, аудиокнига).
*   **Манга/Манхва/Маньхуа/Комиксы (Comic):**
    *   Автор(ы)/Художник(и).
    *   Издательство/Платформа публикации.
    *   Количество глав/томов.
    *   Статус (выпускается, завершено, заморожено).
    *   Тип (манга, манхва, маньхуа, вебтун, комикс).
*   **Аниме (Anime):**
    *   Тип (TV-сериал, фильм, OVA, ONA).
    *   Студия.
    *   Количество серий/сезонов.
    *   Источник (манга, ранобэ, оригинальный сценарий, игра).
    *   Скриншоты, трейлеры.

### 2.3. Основные функции

*   **Система достижений:**
    *   Назначение ачивок за различные действия.
    *   Прогрессия по ачивкам, частичное выполнение.
    *   Всплывающее уведомление при получении.
    *   Просмотр всех полученных и возможных достижений в профиле.
    *   Возможность расшарить достижения.

*   **Управление библиотекой пользователя:**
    *   Добавление контента в личную библиотеку.
    *   Удаление контента из библиотеки.
    *   Присвоение статусов контенту в библиотеке (например, "Просмотрено", "В планах", "Брошено", "Любимое").
    *   Личная оценка и заметки к контенту в библиотеке.
*   **Поиск и фильтрация контента:**
    *   Поиск по названию, ключевым словам.
    *   Фильтрация по типу контента, жанрам, тегам, рейтингу, популярности, году выпуска, платформе (для игр), автору и т.д.
    *   Сортировка результатов поиска.
*   **Карточка медиа-объекта:**
    *   Отображение полной информации о контенте (описание, атрибуты, скриншоты/трейлеры).
    *   Отображение среднего рейтинга и отзывов пользователей.
    *   Возможность добавить/убрать из своей библиотеки.
    *   Возможность оставить свой отзыв и оценку.
    *   Ссылки на связанные произведения (другие части серии, адаптации в других форматах).
*   **Отзывы и оценки:**
    *   Возможность ставить оценку (например, от 1 до 10).
    *   Возможность писать текстовый отзыв.
    *   Редактирование/удаление своих отзывов.
    *   Просмотр отзывов других пользователей.
*   **Коллекции/Списки:**
    *   Создание пользовательских списков (например, "Лучшие хоррор-игры", "Манга для начинающих").
    *   Добавление/удаление медиа-объектов в списки.
    *   Возможность делать списки публичными для других пользователей.
    *   Просмотр публичных списков других пользователей.
*   **Рекомендации:**
    *   Персональные рекомендации на основе просмотренного/оцененного контента и предпочтений пользователя.
    *   Раздел "Популярное", "Новинки", "Высокооцененное".
*   **Система плагинов (Архитектурное требование):**
    *   Хост-приложение с базовой функциональностью (пользователи, поиск, общая структура медиа-объекта).
    *   Отдельные плагины для каждого типа контента (игры, фильмы, книги и т.д.), расширяющие базовую модель и добавляющие специфичную логику и UI.

## 3. Архитектура системы

### 3.1. Технологический стек

*   **Бэкенд:** ASP.NET Core (C#)
*   **База данных:** MongoDB
*   **Фронтенд:** Svelte + TypeScript
*   **Контейнеризация:** Docker

### 3.2. Компоненты системы

*   **Сервис достижений (ASP.NET Core):** Логика получения, назначения, хранения и получения достижений пользователями. Реализация CRUD достижений и логики проверки/назначения. Интерфейс для удобного администрирования набора достижений.

*   **API Gateway (ASP.NET Core):** Единая точка входа для всех клиентских запросов. Маршрутизация запросов к соответствующим микросервисам/модулям.
*   **Сервис аутентификации и авторизации (ASP.NET Core):** Управление пользователями, ролями, токенами доступа.
*   **Сервис управления медиа-контентом (ASP.NET Core):** CRUD операции для MediaItem, управление метаданными, интеграция с общедоступными публичными API для получения информации о медиа-объектах.
*   **Сервис управления библиотеками и списками (ASP.NET Core):** Логика работы с пользовательскими библиотеками и коллекциями.
*   **Сервис отзывов и оценок (ASP.NET Core):** Управление отзывами и рейтингами.
*   **Сервис рекомендаций (ASP.NET Core):** Генерация персональных и общих рекомендаций.
*   **Плагины контента (ASP.NET Core):** Отдельные модули для каждого типа контента, предоставляющие специфичные данные и логику. Могут быть реализованы как отдельные сервисы или как подключаемые сборки.
*   **База данных (MongoDB):** Хранение всех данных приложения.
*   **Фронтенд-приложение (Svelte + TypeScript):** Пользовательский интерфейс.

### 3.3. Структура базы данных (MongoDB - примерная схема коллекций)

*   `achievements`: описание всех достижений (ID, название, описание, тип, иконка, критерий).
*   `userAchievements`: связь пользователь—достижение (userId, achievementId, дата получения, прогресс, статус).

*   `users`: информация о пользователях.
*   `mediaItems`: основная информация о медиа-объектах, общая для всех типов.
*   `mediaItemDetails_games`: специфичные детали для игр.
*   `mediaItemDetails_movies`: специфичные детали для фильмов.
*   `mediaItemDetails_series`: специфичные детали для сериалов.
*   `mediaItemDetails_books`: специфичные детали для книг.
*   `mediaItemDetails_comics`: специфичные детали для комиксов/манги.
*   `mediaItemDetails_anime`: специфичные детали для аниме.
    *   *Примечание: Детализация по типам контента может быть реализована через вложенные документы в `mediaItems` или через отдельные коллекции со ссылками, в зависимости от сложности и частоты запросов.*
*   `userLibraries`: связь пользователь - медиа-объект (статус, личная оценка, дата добавления).
*   `reviews`: отзывы и оценки пользователей.
*   `collections`: пользовательские списки/коллекции.
*   `collectionItems`: связь коллекция - медиа-объект.
*   `universes`: информация о вселенных/сериях.
*   `universeMediaItems`: связь вселенная - медиа-объект.

## 4. Прототипы интерфейсов и экранов (UI/UX)

*(Здесь будут наброски или описания основных экранов. Для начала можно описать текстом, позже можно добавить wireframes/mockups)*

### 4.1. Основные экраны

*   **Профиль пользователя:**
    *   Блок отображения достижений (значки, краткое описание, прогресс по частично выполненным ачивкам).
    *   Возможность раскрыть подробности достижений, фильтровать/соритровать, делиться.
*   **Уведомления/Всплывающие окна:**
    *   При получении нового достижения, пользователь видит всплывающее уведомление с описанием и иконкой ачивки.

*   **Главная страница (Dashboard):**
    *   Персональные рекомендации.
    *   Новинки по разным категориям.
    *   Популярный контент.
    *   Быстрый доступ к своей библиотеке.
*   **Страница поиска:**
    *   Строка поиска.
    *   Фильтры (тип контента, жанры, теги, рейтинг, год и т.д.).
    *   Результаты поиска в виде сетки/списка карточек.
*   **Страница медиа-объекта (Карточка контента):**
    *   Постер/Обложка.
    *   Название, описание, жанры, теги, рейтинг.
    *   Специфичная информация (разработчик, режиссер, автор и т.д.).
    *   Скриншоты/Трейлеры.
    *   Кнопки: "Добавить в библиотеку", "Оценить/Написать отзыв".
    *   Раздел "Отзывы пользователей".
    *   Раздел "Связанный контент" (другие части серии, адаптации).
*   **Страница личной библиотеки:**
    *   Вкладки/фильтры по статусам ("Смотрю/Играю", "Просмотрено/Пройдено", "В планах", "Брошено", "Любимое").
    *   Отображение контента из библиотеки пользователя.
    *   Возможность изменить статус, оценку, добавить заметку.
*   **Страница профиля пользователя:**
    *   Аватар, имя, описание.
    *   Статистика (количество просмотренного, оцененного контента).
    *   Публичные списки пользователя.
*   **Страница создания/редактирования списка:**
    *   Поля для названия и описания списка.
    *   Интерфейс для добавления/удаления медиа-объектов в список.
    *   Настройка приватности (публичный/приватный).
*   **Страницы регистрации и авторизации.**

### 4.2. Общие принципы дизайна

*   **Современный и чистый вид:** Использование минималистичных элементов, качественной типографики и приятной цветовой палитры.
*   **Интуитивная навигация:** Понятная структура меню и переходов между разделами.
*   **Адаптивность:** Корректное отображение на десктопных и мобильных устройствах.
*   **Акцент на контенте:** Визуальные элементы (постеры, скриншоты) должны быть в центре внимания.
*   **Пользовательский опыт (UX):** Продуманные сценарии взаимодействия, минимизация количества кликов для выполнения частых действий.

## 5. План разработки (Этапы)

### Этап 1: Хост-приложение и базовый функционал (MVP)

*   **Задачи:**
    *   [ ] Настройка окружения разработки (ASP.NET, Svelte, MongoDB, Docker).
    *   [ ] Реализация системы аутентификации и авторизации пользователей.
    *   [ ] Создание базовой модели MediaItem и API для управления (CRUD).
    *   [ ] Реализация базового поиска (по названию).
    *   [ ] Реализация личной библиотеки пользователя (добавление/удаление, базовые статусы).
    *   [ ] Создание базовой карточки медиа-объекта (отображение основной информации).
    *   [ ] Фронтенд: основные страницы (главная, поиск, карточка, библиотека, профиль, логин/регистрация) с базовым дизайном.
*   **Цель:** Функционирующее ядро приложения с возможностью добавлять и просматривать один общий тип контента (например, "Общий медиа-объект" без специфичных полей).

### Этап 2: Разработка плагина для первого типа контента (например, Фильмы)

*   **Задачи:**
    *   [ ] Проектирование и реализация модели данных для фильмов (специфичные поля).
    *   [ ] Разработка API для плагина фильмов (CRUD, специфичные фильтры).
    *   [ ] Интеграция плагина с хост-приложением.
    *   [ ] Обновление фронтенда для отображения специфичной информации о фильмах на карточке и в поиске.
    *   [ ] Добавление специфичных фильтров для фильмов.
*   **Цель:** Полноценная поддержка одного типа контента.

### Этап 3: Расширение функционала: Отзывы, Рейтинги, Коллекции, Достижения

*   **Задачи:**
    *   [ ] Реализация системы оценок и отзывов.
    *   [ ] Интеграция отзывов в карточку медиа-объекта.
    *   [ ] Реализация функционала создания и управления пользовательскими коллекциями/списками.
    *   [ ] Возможность делиться коллекциями.
    *   [ ] Реализация и интеграция системы достижений.
*   **Цель:** Улучшение социального взаимодействия, персонализации, мотивации и вовлечённости пользователей за счёт достижений.

### Этап 4: Разработка плагинов для остальных типов контента

*   **Задачи (повторяются для каждого типа: Игры, Книги, Манга, Аниме):**
    *   [ ] Проектирование и реализация модели данных.
    *   [ ] Разработка API для плагина.
    *   [ ] Интеграция плагина.
    *   [ ] Обновление фронтенда.
*   **Цель:** Полная поддержка всех заявленных типов контента.

### Этап 5: Реализация системы рекомендаций

*   **Задачи:**
    *   [ ] Выбор и реализация алгоритма(ов) рекомендаций.
    *   [ ] Интеграция рекомендаций на главной странице и в других релевантных местах.
*   **Цель:** Повышение вовлеченности пользователей.

### Этап 6: Улучшения UI/UX, Тестирование, Оптимизация

*   **Задачи:**
    *   [ ] Детальная проработка дизайна и пользовательского опыта.
    *   [ ] Написание Unit и интеграционных тестов.
    *   [ ] Оптимизация производительности бэкенда и фронтенда.
    *   [ ] Сбор обратной связи и доработка.
*   **Цель:** Стабильное, производительное и удобное приложение.

## 6. Документация

*   [ ] **PROJECT_PLAN.md** (этот документ) - общая постановка задачи, архитектура, план.
*   [ ] **API_DOCUMENTATION.md** - описание эндпоинтов API (будет генерироваться, например, через Swagger/OpenAPI).
*   [ ] **COMPONENT_DOCUMENTATION/** - папка с документацией по отдельным компонентам/модулям/плагинам (описание, примеры использования).
*   [ ] **ARCHITECTURE_OVERVIEW.md** - глобальная документация по логике приложения и его архитектуре.

## 7. Чек-лист выполнения (Общий)

*   [ ] Детальная проработка постановки задачи (PROJECT_PLAN.md) - **В процессе**
*   [ ] Прототипы интерфейсов и экранов (в PROJECT_PLAN.md или отдельно) - **В процессе**
*   [ ] Настройка базового проекта (ASP.NET, Svelte, Docker, MongoDB)
*   [ ] Реализация ядра приложения (MVP)
*   [ ] Реализация плагинов для каждого типа контента
*   [ ] Реализация системы отзывов и коллекций
*   [ ] Реализация системы рекомендаций
*   [ ] Тестирование
*   [ ] Документирование
*   [ ] Развертывание

---
*Этот документ будет обновляться по мере продвижения проекта.*